<UserControl x:Class="SeeShellsV2.UI.TimelineView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
			 xmlns:local="clr-namespace:SeeShellsV2.UI"
			 xmlns:data="clr-namespace:SeeShellsV2.Data"
			 xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
			 Loaded="GenerateTimeline"
			 mc:Ignorable="d" 
			 d:DesignHeight="450" d:DesignWidth="800">
	<UserControl.Resources>
		<local:TimelinePanel x:Key="TimelinePanel"/>
		<local:TimelineSlicer x:Key="TimelineSlicer"/>
	</UserControl.Resources>
	<ScrollViewer HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden"
			PreviewMouseLeftButtonDown="ScrollViewer_PreviewMouseLeftButtonDown"
			PreviewMouseLeftButtonUp="ScrollViewer_PreviewMouseLeftButtonUp"
			MouseMove="ScrollViewer_MouseMove"
			PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
		<!-- ItemsControl displays a collection of items -->
	<ItemsControl x:Name="Timeline" HorizontalContentAlignment="Stretch">

		<!-- Set the source of the ItemsControl to the IShellEventCollection repo -->
		<ItemsControl.ItemsSource>

			<!--Use Converter to split the event collection into discrete stacks by timestamp.
				TimelineSlicer(IShellEventCollection) => IEnumerable<IEnumerable<IShellEvent>>-->
			<MultiBinding Converter="{StaticResource TimelineSlicer}">
				<!-- Bind ShellEvents from TimelineVM to the itemscontrol -->
				<Binding Path="ShellEvents"/>
				<!-- Also Bind Count so the view will redraw when Count is changed -->
				<Binding Path="ShellEvents.Count"/>
			</MultiBinding>
		</ItemsControl.ItemsSource>

			<ItemsControl.LayoutTransform>
				<ScaleTransform x:Name="scaleTransform" />
			</ItemsControl.LayoutTransform>

		<!--Use a horizontal stack panel to wrap list of collections.
			We can replace this with a custom panel for stack positioning
			and user interactions.-->
		<ItemsControl.ItemsPanel>
			<ItemsPanelTemplate>
				<local:TimelinePanel x:Name="timelinePanel" ColumnWidth="170"/>
			</ItemsPanelTemplate>
		</ItemsControl.ItemsPanel>


		<ItemsControl.ItemTemplate>
			<DataTemplate>
					<StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Bottom">
						<!--<Separator Width="3" Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" Margin="0,0,0,0"/>-->
						<!--<StackPanel VerticalAlignment="Bottom">-->
						<ItemsControl ItemsSource="{Binding}" Margin="3,0,3,0">

							<ItemsControl.ItemsPanel>
								<ItemsPanelTemplate>
									<StackPanel/>
								</ItemsPanelTemplate>
							</ItemsControl.ItemsPanel>


							<ItemsControl.ItemTemplate>
								<DataTemplate>
									<Border BorderBrush="Gainsboro" BorderThickness="1" CornerRadius="4,4,4,4">
										<Border.Background>
											<LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
												<GradientStop Color="#0F830C" Offset="0.0" />
												<GradientStop Color="#0F730C" Offset="0.5" />
												<GradientStop Color="#0F830C" Offset="1.0" />
											</LinearGradientBrush>
										</Border.Background>
										<StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Width="160">
											<TextBlock FontSize="12" FontFamily="Verdana" Margin="0,3,0,3" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" Text="{Binding TypeName}"/>
											<TextBlock FontSize="12" FontFamily="Verdana" Margin="3,0,3,0" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" Text="{Binding TimeStamp}"/>
											<TextBlock FontSize="12" FontFamily="Verdana" Margin="0,3,0,3" Foreground="White" HorizontalAlignment="Center" VerticalAlignment="Center" Text="{Binding Description}"/>
										</StackPanel>
									</Border>
								</DataTemplate>
							</ItemsControl.ItemTemplate>


						</ItemsControl>

						<!--</StackPanel>-->
					</StackPanel>
				</DataTemplate>
		</ItemsControl.ItemTemplate>

	</ItemsControl>
	</ScrollViewer>
</UserControl>
